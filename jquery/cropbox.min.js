"use strict";(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){var t=function(t,i){var i=i||n(t.imageBox),r={state:{},ratio:1,options:t,imageBox:i,thumbBox:i.find(t.thumbBox),spinner:i.find(t.spinner),image:new Image,scale:t.scale?t.scale:1,format:t.format?t.format:"image/png",getDataURL:function(){var s;this.image.height=this.image.height*this.scale;this.image.width=this.image.width*this.scale;var u=this.thumbBox.width(),f=this.thumbBox.height(),n=document.createElement("canvas"),e=i.css("background-position").split(" "),o=i.css("background-size").split(" "),t=parseInt(e[0])-i.width()/2+u/2,r=parseInt(e[1])-i.height()/2+f/2,h=parseInt(o[0])*this.scale,c=parseInt(o[1])*this.scale,l=parseInt(this.image.height),a=parseInt(this.image.width);return n.width=u*this.scale,n.height=f*this.scale,t=t*this.scale,r=r*this.scale,s=n.getContext("2d"),s.drawImage(this.image,0,0,a,l,t,r,h,c),n.toDataURL(this.format)},getBlob:function(){for(var r=this.getDataURL(),u=r.replace("data:"+this.format+";base64,",""),t=atob(u),i=[],n=0;n<t.length;n++)i.push(t.charCodeAt(n));return new Blob([new Uint8Array(i)],{type:this.format})},zoomIn:function(){this.ratio*=1.1;u()},zoomOut:function(){this.ratio*=.9;u()}},u=function(){var n=parseInt(r.image.width)*r.ratio,t=parseInt(r.image.height)*r.ratio,u=(i.width()-n)/2,f=(i.height()-t)/2;i.css({"background-image":"url("+r.image.src+")","background-size":n+"px "+t+"px","background-position":u+"px "+f+"px","background-repeat":"no-repeat"})},e=function(n){n.stopImmediatePropagation();r.state.dragable=!0;r.state.mouseX=n.clientX;r.state.mouseY=n.clientY},o=function(n){if(n.stopImmediatePropagation(),r.state.dragable){var u=n.clientX-r.state.mouseX,f=n.clientY-r.state.mouseY,t=i.css("background-position").split(" "),e=u+parseInt(t[0]),o=f+parseInt(t[1]);i.css("background-position",e+"px "+o+"px");r.state.mouseX=n.clientX;r.state.mouseY=n.clientY}},f=function(n){n.stopImmediatePropagation();r.state.dragable=!1},s=function(n){r.ratio*=n.originalEvent.wheelDelta>0||n.originalEvent.detail<0?1.1:.9;u()};r.spinner.show();r.image.onload=function(){r.image.width=parseInt(r.image.width)/r.scale;r.image.height=parseInt(r.image.height)/r.scale;r.spinner.hide();u();i.bind("mousedown",e);i.bind("mousemove",o);n(window).bind("mouseup",f);i.bind("mousewheel DOMMouseScroll",s)};r.image.src=t.imgSrc;i.on("remove",function(){n(window).unbind("mouseup",f)});return r};jQuery.fn.cropbox=function(n){return new t(n,this)}});
//# sourceMappingURL=cropbox.min.js.map
